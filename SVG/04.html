<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <style>
      .new-payment-icon {
        box-sizing: border-box;
        width: 86px;
        height: 18px;
        line-height: 18px;
        text-align: center;
        background: linear-gradient(86.32deg, #ec7939 0%, #e9645d 83.26%);
        border-radius: 5px 5px 5px 0px;
        font-style: normal;
        font-weight: 500;
        font-size: 12px;
        color: #fff;
      }
    </style>
    <div class="new-payment-icon">New Payment</div>
    <script>
      const tableData = [
        {
          category_id: '',
          sort_id: '0',
          class_code: '0',
          level_no: '0',
          isselected: '0',
          file_path: '',
          file_name: '',
          fund_id: '1054',
          isleaf: '0',
          class_name: '投资数据接口',
          file_code: '53',
          compareFilename: '',
          compareisselected: '0',
          comparefile_path: '',
          isDifferent: '',
          children: [
            {
              category_id: '',
              sort_id: '1',
              class_code: '53',
              level_no: '1',
              isselected: '0',
              file_path: '',
              file_name: '',
              fund_id: '1054',
              isleaf: '0',
              class_name: '恒生O32交易接口',
              file_code: '5325',
              compareFilename: '',
              compareisselected: '0',
              comparefile_path: '',
              isDifferent: '',
              children: [
                {
                  category_id: '53252',
                  sort_id: '2',
                  class_code: '5325',
                  level_no: '2',
                  isselected: '1',
                  business: [],
                  dir_type: '1',
                  file_path: '/rwerwerwerwer',
                  file_name: 'TIFENTRUSTS*[YYYYMMDD].DBF',
                  isleaf: '1',
                  class_name: '恒生O32-投资委托数据',
                  file_code: '5329',
                  user_operate: '1',
                  dtime_operate: '20221110.191308',
                  link_workid: '',
                  fund_id: '1054',
                  compareFilename: 'TIFENTRUSTS*[YYYYMMDD].DBF',
                  compareDirType: '1',
                  compareisselected: '1',
                  comparefile_path: '/rwerwerwerwer',
                  compareBusiness: '',
                  isDifferent: '',
                  business_content: '',
                  id: '5329'
                }
              ],
              expand: true,
              id: 1
            },
            {
              category_id: '',
              sort_id: '3',
              class_code: '53',
              level_no: '1',
              isselected: '0',
              file_path: '',
              file_name: '',
              fund_id: '1054',
              isleaf: '0',
              class_name: '投资数据接口',
              file_code: '5330',
              compareFilename: '',
              compareisselected: '0',
              comparefile_path: '',
              isDifferent: '',
              children: [
                {
                  category_id: '53301',
                  sort_id: '4',
                  class_code: '5330',
                  level_no: '2',
                  isselected: '1',
                  business: [],
                  dir_type: '1',
                  file_path: '',
                  file_name: 'fa6_jys_bondsettle_[YYYYMMDD].dbf',
                  isleaf: '1',
                  class_name: '投资主推_交易所_交收_债券',
                  file_code: '8704',
                  user_operate: '1',
                  dtime_operate: '20221110.191308',
                  link_workid: '',
                  fund_id: '1054',
                  compareFilename: 'fa6_jys_bondsettle_[YYYYMMDD].dbf',
                  compareDirType: '1',
                  compareisselected: '1',
                  comparefile_path: '',
                  compareBusiness: '',
                  isDifferent: '',
                  business_content: '',
                  id: '8704'
                },
                {
                  category_id: '53301',
                  sort_id: '5',
                  class_code: '5330',
                  level_no: '2',
                  isselected: '1',
                  business: [],
                  dir_type: '1',
                  file_path: '/7890',
                  file_name: 'fa6_yhj_hgdeal_[YYYYMMDD].dbf',
                  isleaf: '1',
                  class_name: '投资主推_银行间_成交确认_回购',
                  file_code: '8705',
                  user_operate: '1',
                  dtime_operate: '20221110.191308',
                  link_workid: '',
                  fund_id: '1054',
                  compareFilename: 'fa6_yhj_hgdeal_[YYYYMMDD].dbf',
                  compareDirType: '1',
                  compareisselected: '1',
                  comparefile_path: '/7890',
                  compareBusiness: '',
                  isDifferent: '',
                  business_content: '',
                  id: '8705'
                },
                {
                  category_id: '53301',
                  sort_id: '6',
                  class_code: '5330',
                  level_no: '2',
                  isselected: '1',
                  business: [],
                  dir_type: '1',
                  file_path: '',
                  file_name: 'fa6_jys_repodeal_[YYYYMMDD].dbf',
                  isleaf: '1',
                  class_name: '投资主推_交易所_成交确认_回购',
                  file_code: '8706',
                  user_operate: '1',
                  dtime_operate: '20221110.191308',
                  link_workid: '',
                  fund_id: '1054',
                  compareFilename: 'fa6_jys_repodeal_[YYYYMMDD].dbf',
                  compareDirType: '1',
                  compareisselected: '1',
                  comparefile_path: '',
                  compareBusiness: '',
                  isDifferent: '',
                  business_content: '',
                  id: '8706'
                }
              ],
              expand: true,
              id: 3
            },
            {
              category_id: '',
              sort_id: '7',
              class_code: '53',
              level_no: '1',
              isselected: '0',
              file_path: '',
              file_name: '',
              fund_id: '1054',
              isleaf: '0',
              class_name: '资管(AM)证券投资',
              file_code: '5333',
              compareFilename: '',
              compareisselected: '0',
              comparefile_path: '',
              isDifferent: '',
              children: [
                {
                  category_id: '53331',
                  sort_id: '8',
                  class_code: '5333',
                  level_no: '2',
                  isselected: '1',
                  business: [],
                  dir_type: '1',
                  file_path: '',
                  file_name: '',
                  isleaf: '1',
                  class_name: '场内交易数据',
                  file_code: '9231',
                  user_operate: '1',
                  dtime_operate: '20221110.191308',
                  link_workid: '',
                  fund_id: '1054',
                  compareFilename: '',
                  compareDirType: '1',
                  compareisselected: '1',
                  comparefile_path: '',
                  compareBusiness: '',
                  isDifferent: '',
                  business_content: '',
                  id: '9231'
                }
              ],
              expand: true,
              id: 7
            }
          ],
          id: '53',
          expand: true
        }
      ];
      function getLeafItemListFromTableData(tableData) {
        if (!tableData || tableData.length === 0) return [];
        const result = [];
        const queue = [];
        for (let i = 0, len = tableData.length; i < len; i++) {
          queue.push(tableData[i]);
        }
        while (queue.length > 0) {
          // 关键循环
          const len = queue.length;
          for (let i = 0; i < len; i++) {
            const node = queue.shift();
            if (node.isleaf === '1' || node.level_no === '2') {
              if (!node.dir_type || node.dir_type == '1') {
                result.push(node);
              }
            }
            console.log(node.file_code);
            if (node.children && node.children.length > 0) {
              queue.push(...node.children);
            }
          }
        }
        return result;
      }
      console.log(getLeafItemListFromTableData(tableData));
    </script>
  </body>
</html>
